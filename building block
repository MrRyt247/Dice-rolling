import random
import tkinter as tk
from tkinter import PhotoImage

roll_history = []

def roll_dice(num_dice, sides):
    rolls = [random.randint(1, sides) for _ in range(num_dice)]
    total = sum(rolls)
    return rolls, total

def roll_button_clicked(event=None):
    num_dice = int(num_dice_entry.get())
    sides = int(sides_entry.get())
    rolls, total = roll_dice(num_dice, sides)
    result_text = f"Rolls:\n{', '.join(str(roll) for roll in rolls)}\nTotal: {total}"
    result_label.config(text=result_text)
    roll_history.append(f"Rolled {num_dice} dice with {sides} sides: {rolls}\nTotal: {total}")

def clear_history():
    roll_history.clear()
        
def view_history():
    history_window = tk.Toplevel(root)
    history_window.title("Roll History")
    history_window.configure(bg='dark blue')
    history_window.iconphoto(False, PhotoImage(file="src/assets/history_favicon.png"))
    history_text = tk.Text(history_window, wrap=tk.WORD, font=("Arial", 12), fg='dark blue', bg='#ddd')
    history_text.pack(padx=5, pady=5)
    for roll in roll_history:
        history_text.insert(tk.END, roll + "\n\n")

# Create main window
root = tk.Tk()
root.title("Dice Rolling Simulator")
root.geometry("600x450")
root.resizable(True, True)
root.configure(bg='light blue')
root.iconphoto(False, PhotoImage(file="src/assets/favicon.png"))

# Create widgets
num_dice_label = tk.Label(root, text="Number of Dice:", bg='light blue', font=("Pristina", 16))
num_dice_entry = tk.Entry(root, bg='white', font=("Arial", 12), highlightthickness=1, highlightbackground="dark blue", highlightcolor="blue")
sides_label = tk.Label(root, text="Number of Sides:", bg='light blue', font=("Arial", 16))
sides_entry = tk.Entry(root, bg='white', font=("Arial", 12), highlightthickness=1, highlightbackground="dark blue", highlightcolor="blue")
roll_button = tk.Button(root, text="Roll Dice", command=roll_button_clicked, fg='dark blue', bg='white', font=("Arial", 14), bd=1, padx=5, relief='solid')
roll_button.config(activeforeground="white", activebackground="dark blue")  
result_label = tk.Label(root, text="\n", bg='light blue', wraplength=500, font=("Arial", 16))
view_history_button = tk.Button(root, text="View History", command=view_history, fg='white', bg='dark blue', font=("Arial", 12, 'bold'), padx=5, bd=1, relief="ridge")
clear_history_button = tk.Button(root, text="Clear History", command=clear_history, bg='red', font=("Arial", 12, 'bold'), padx=5, bd=1, relief="sunken")

# Bind Enter key to roll_button_clicked
root.bind('<Return>', roll_button_clicked)

# Layout widgets
root.columnconfigure(0, weight=1)
root.columnconfigure(4, weight=1)
root.rowconfigure(0, weight=1)
root.rowconfigure(7, weight=1)

num_dice_label.grid(row=1, column=1, padx=10, pady=5)
num_dice_entry.grid(row=1, column=2, padx=10, pady=5)
sides_label.grid(row=2, column=1, padx=10, pady=5)
sides_entry.grid(row=2, column=2, padx=10, pady=5)
roll_button.grid(row=3, column=1, columnspan=2, padx=10, pady=10)
result_label.grid(row=4, column=1, columnspan=2, padx=10, pady=10)
view_history_button.grid(row=7, column=1, columnspan=1, pady=5)
clear_history_button.grid(row=7, column=2, columnspan=1, pady=5)

# Start the GUI event loop
root.mainloop()